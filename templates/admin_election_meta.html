{% extends "base_admin.html" %}
{% block title %}SchulzeVote Admin · Metadados da votação{% endblock %}

{% block content %}
  {% set secret_qs = request.args.get('secret','') %}
  <h1>Metadados da votação</h1>
  {% if msg %}<p class="alert ok">{{ msg }}</p>{% endif %}
  {% if warn %}<p class="alert warn">{{ warn }}</p>{% endif %}

  <div class="card">
    <form method="POST" class="row" style="flex-direction:column; gap:12px; align-items:stretch">
      {% if secret_qs %}<input type="hidden" name="secret" value="{{ secret_qs }}">{% endif %}

      <div class="grid" style="grid-template-columns:1fr 1fr">
        <label>EID<br>
          <input type="text" name="eid" value="{{ election_id }}">
        </label>
        <label>Título<br>
          <input type="text" name="title" value="{{ (meta.title if meta else '') }}">
        </label>
      </div>

      <div class="grid" style="grid-template-columns:1fr 1fr 1fr">
        <label>Data<br>
          <input type="date" name="date" value="{{ (meta.date if meta else '') }}">
        </label>
        <label>Hora<br>
          <input type="time" name="time" value="{{ (meta.time if meta else '') }}">
        </label>
        <label>Fuso<br>
          <select name="tz" style="background:var(--input);border:1px solid var(--border);color:var(--text);padding:10px;border-radius:10px">
            {% for tz in tz_options %}
              <option {% if meta and meta.tz==tz %}selected{% endif %}>{{ tz }}</option>
            {% endfor %}
          </select>
        </label>
      </div>

      <label>Categoria (texto livre)<br>
        <input type="text" name="category" value="{{ (meta.category if meta else '') }}">
      </label>

      <div class="row">
        <button class="btn accent" type="submit">Salvar metadados</button>
        <a class="btn" href="/admin/candidates{% if secret_qs %}?secret={{ secret_qs|urlencode }}{% endif %}">Candidatos &amp; prazo</a>
        <a class="btn" href="/admin/home{% if secret_qs %}?secret={{ secret_qs|urlencode }}{% endif %}">Voltar ao painel</a>
      </div>
    </form>
  </div>

  <div class="card">
    <h3 style="margin:0 0 8px 0">Visualização pública</h3>
    <div class="row">
      <a class="btn" href="/public/{{ election_id }}/results" target="_blank" rel="noopener">Resultados (público)</a>
      <a class="btn" href="/public/{{ election_id }}/audit" target="_blank" rel="noopener">Auditoria (público)</a>
    </div>
  </div>
{% endblock %}
