<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Votar</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body{font-family:system-ui,Arial,sans-serif;max-width:860px;margin:40px auto;padding:0 16px}
    input,button{padding:8px;border:1px solid #ddd;border-radius:8px}
    table{border-collapse:collapse} td,th{border:1px solid #ddd;padding:6px 8px}
  </style>
</head>
<body>
  <h1>Votar</h1>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <ul>
        {% for cat,msg in messages %}
          <li><b>{{ cat }}</b>: {{ msg }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  {% endwith %}

  <form method="POST">
    <p>
      <label>Chave de votação:
        <input name="voter_id" placeholder="SUA-CHAVE-EX: ABCD-EFGH-IJKL" required>
      </label>
    </p>

    <p><b>Informe a ordem de preferência</b> (1 = mais preferido). Deixe em branco para não ranquear.</p>
    <table>
      <tr><th>Candidato</th><th>Rank</th></tr>
      {% for c in candidates %}
        <tr>
          <td>{{ c }}</td>
          <td>
            {% if "Branco" in c or "Nulo" in c %}
              <small>Use “Voto em Branco/Nulo” abaixo</small>
            {% else %}
              <input name="rank_{{ loop.index0 }}" style="width:80px" pattern="\d*">
              <input type="hidden" name="cand_{{ loop.index0 }}" value="{{ c }}">
            {% endif %}
          </td>
        </tr>
      {% endfor %}
    </table>

    <p>Ou escolha voto especial:
      <label><input type="radio" name="special_vote" value=""> (nenhum)</label>
      <label><input type="radio" name="special_vote" value="BLANK"> Branco</label>
      <label><input type="radio" name="special_vote" value="NULL"> Nulo</label>
    </p>

    <button type="submit">Enviar voto</button>
  </form>

  <p><a href="/">Início</a></p>
</body>
</html>
