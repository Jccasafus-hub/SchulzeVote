{% extends "base.html" %}
{% block title %}SchulzeVote ¬∑ In√≠cio{% endblock %}

{% block content %}
  <div class="wrap">
    <h1>SchulzeVote</h1>
    <p class="muted">Sistema de vota√ß√£o com m√©todo de Schulze, auditoria p√∫blica e anonimato de c√©dulas.</p>

    <!-- Acesso r√°pido -->
    <div class="card">
      {% set eid_atual = get_current_election_id() %}
      <div class="row" style="justify-content:space-between;gap:8px">
        <div>
          <div class="pill">EID atual: <b>{{ eid_atual }}</b></div>
          <div style="margin-top:8px" class="row">
            <a class="btn accent" href="/public/{{ eid_atual }}/results">Ver resultados (EID atual)</a>
            <a class="btn" href="/public/{{ eid_atual }}/audit">Ver auditoria (EID atual)</a>
          </div>
        </div>
        <div class="row">
          <a class="btn ok" href="/login">Entrar para votar</a>
          <a class="btn ghost" href="/register">Criar cadastro</a>
        </div>
      </div>
      <div class="sep"></div>
      <div class="row">
        <a class="btn ghost" href="/public/elections" target="_blank" rel="noopener">Lista de vota√ß√µes (todas)</a>
        <span class="muted">Abre um JSON com todos os EIDs j√° existentes.</span>
      </div>
    </div>

    <!-- Abrir por EID -->
    <div class="card">
      <h3>Abrir por EID</h3>
      <p class="muted">Digite o identificador da vota√ß√£o para acessar os resultados e a auditoria.</p>
      <div class="row">
        <input id="eid" type="text" placeholder="ex.: teste-2025-01" style="min-width:260px">
        <a class="btn" href="#" onclick="openRes();return false;">Resultados</a>
        <a class="btn" href="#" onclick="openAudit();return false;">Auditoria</a>
      </div>
    </div>

    <!-- Guia Schulze -->
    <div class="card">
      <h3>üìò Como funciona o m√©todo de Schulze</h3>
      <p>Veja uma explica√ß√£o simplificada com exemplos de vota√ß√£o, incluindo votos em branco e nulos.</p>
      <a class="btn accent" href="{{ url_for('schulze_guide') }}">Abrir guia</a>
    </div>
  </div>

  <script>
    function sanitize(s){ return (s||"").trim(); }
    function openRes(){
      const eid = sanitize(document.getElementById('eid').value);
      if(!eid){ alert("Informe um EID."); return; }
      window.location.href = "/public/" + encodeURIComponent(eid) + "/results";
    }
    function openAudit(){
      const eid = sanitize(document.getElementById('eid').value);
      if(!eid){ alert("Informe um EID."); return; }
      window.location.href = "/public/" + encodeURIComponent(eid) + "/audit";
    }
  </script>
{% endblock %}
